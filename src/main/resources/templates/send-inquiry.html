<!DOCTYPE html>
<html lang="da" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Carport Sketch</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        svg {
            border: 1px solid black;
            width: 800px;
            height: 600px;
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
<div class="container mt-5">
    <h1>Forespørgsel på Carport</h1>
    <form id="carportForm">
        <!-- Bredde -->
        <div class="mb-3">
            <label for="carportWidth" class="form-label">Bredde på Carport (cm)</label>
            <select name="carportWidth" id="carportWidth" class="form-select">
                <option value="300">300</option>
                <option value="400">400</option>
            </select>
        </div>
        <!-- Længde -->
        <div class="mb-3">
            <label for="carportLength" class="form-label">Længde på Carport (cm)</label>
            <select name="carportLength" id="carportLength" class="form-select">
                <option value="500">500</option>
                <option value="600">600</option>
            </select>
        </div>
        <!-- Redskabsrum -->
        <div class="mb-3">
            <label for="shedWidth" class="form-label">Bredde på redskabsrum (cm)</label>
            <select name="shedWidth" id="shedWidth" class="form-select">
                <option value="0">Ingen skur</option>
                <option value="150">150</option>
            </select>
        </div>
        <div class="mb-3">
            <label for="shedLength" class="form-label">Længde på redskabsrum (cm)</label>
            <select name="shedLength" id="shedLength" class="form-select">
                <option value="0">Ingen skur</option>
                <option value="200">200</option>
            </select>
        </div>
    </form>
    <div class="mt-5">
        <h3>Din Carport Tegning</h3>
        <svg id="carportSketch"></svg>
    </div>
</div>

<script>
    const form = document.getElementById("carportForm");
    const sketch = document.getElementById("carportSketch");

    let selectedElement = null;
    let offset = { x: 0, y: 0 };

    // Function to draw the grid
    function drawGrid() {
        const gridSize = 20; // Size of each grid square in pixels
        const svgWidth = sketch.clientWidth;
        const svgHeight = sketch.clientHeight;

        for (let x = 0; x <= svgWidth; x += gridSize) {
            const verticalLine = document.createElementNS("http://www.w3.org/2000/svg", "line");
            verticalLine.setAttribute("x1", x);
            verticalLine.setAttribute("y1", 0);
            verticalLine.setAttribute("x2", x);
            verticalLine.setAttribute("y2", svgHeight);
            verticalLine.setAttribute("stroke", "#ddd");
            verticalLine.setAttribute("stroke-width", 0.5);
            sketch.appendChild(verticalLine);
        }

        for (let y = 0; y <= svgHeight; y += gridSize) {
            const horizontalLine = document.createElementNS("http://www.w3.org/2000/svg", "line");
            horizontalLine.setAttribute("x1", 0);
            horizontalLine.setAttribute("y1", y);
            horizontalLine.setAttribute("x2", svgWidth);
            horizontalLine.setAttribute("y2", y);
            horizontalLine.setAttribute("stroke", "#ddd");
            horizontalLine.setAttribute("stroke-width", 0.5);
            sketch.appendChild(horizontalLine);
        }
    }

    // Function to draw the carport and shed
    function drawCarport() {
        const width = parseInt(document.getElementById("carportWidth").value || 0);
        const length = parseInt(document.getElementById("carportLength").value || 0);
        const shedWidth = parseInt(document.getElementById("shedWidth").value || 0);
        const shedLength = parseInt(document.getElementById("shedLength").value || 0);

        // Clear the SVG
        sketch.innerHTML = "";

        // Draw the grid
        drawGrid();

        // Draw the carport
        const carport = document.createElementNS("http://www.w3.org/2000/svg", "rect");
        carport.setAttribute("x", 50);
        carport.setAttribute("y", 50);
        carport.setAttribute("width", width / 5);
        carport.setAttribute("height", length / 5);
        carport.setAttribute("fill", "lightblue");
        carport.setAttribute("stroke", "black");
        sketch.appendChild(carport);

        // Draw the shed
        if (shedWidth > 0 && shedLength > 0) {
            const shed = document.createElementNS("http://www.w3.org/2000/svg", "rect");
            shed.setAttribute("x", 50 + (width / 5) - (shedWidth / 5)); // Position shed initially
            shed.setAttribute("y", 50 + (length / 5) - (shedLength / 5));
            shed.setAttribute("width", shedWidth / 5);
            shed.setAttribute("height", shedLength / 5);
            shed.setAttribute("fill", "brown");
            shed.setAttribute("stroke", "black");
            shed.setAttribute("cursor", "move"); // Show move cursor
            sketch.appendChild(shed);

            // Add event listeners for drag-and-drop
            shed.addEventListener("mousedown", startDrag);
            sketch.addEventListener("mousemove", drag);
            sketch.addEventListener("mouseup", endDrag);
            sketch.addEventListener("mouseleave", endDrag);
        }
    }

    // Drag-and-drop functions
    function startDrag(event) {
        if (event.target.tagName === "rect" && event.target.getAttribute("fill") === "brown") {
            selectedElement = event.target;
            const rect = selectedElement.getBoundingClientRect();
            offset = {
                x: event.clientX - rect.x,
                y: event.clientY - rect.y,
            };
        }
    }

    function drag(event) {
        if (selectedElement) {
            const x = event.clientX - offset.x;
            const y = event.clientY - offset.y;
            selectedElement.setAttribute("x", Math.round(x / 20) * 20); // Snap to grid
            selectedElement.setAttribute("y", Math.round(y / 20) * 20); // Snap to grid
        }
    }

    function endDrag() {
        selectedElement = null;
    }

    // Event listener to redraw the carport on form changes
    form.addEventListener("change", drawCarport);

    // Initial draw
    drawCarport();
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
